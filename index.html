<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>EVOLUWILL</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="css/style.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=BBH+Bartle&display=swap" rel="stylesheet"> <!-- Certifique-se de que o link está correto -->
   <link rel="icon" href="img/Ellipse 1.png" type="img/icon">
</head>

<body class="page-light">
  <!-- Cabeçalho global -->
  <header class="app-header">
    <div class="app-header-inner">
      <div class="logo-nome-index">EVOLUWILL</div>
        <!-- ECG decorativo (batimentos) -->
    <div class="header-ecg" aria-hidden="true">
      <svg viewBox="0 0 520 60" role="presentation" focusable="false">
        <path class="ecg-path ecg-track" d="M0 30 L60 30 L80 30 L95 30 L110 30 L125 30 L140 30 L160 30 L180 30 L200 30 L220 30 L240 30 L260 30 L280 30 L300 30 L320 30 L340 30 L360 30 L380 30 L400 30 L420 30 L440 30 L460 30 L520 30" />
        <g class="ecg-move">
          <path class="ecg-path" d="M0 30 L55 30 L70 30 L82 10 L94 50 L108 22 L120 30 L160 30 L175 30 L187 18 L198 42 L212 30 L260 30 L315 30 L330 30 L342 10 L354 50 L368 22 L380 30 L520 30" />
          <path class="ecg-path" d="M520 30 L575 30 L590 30 L602 10 L614 50 L628 22 L640 30 L680 30 L695 30 L707 18 L718 42 L732 30 L780 30 L835 30 L850 30 L862 10 L874 50 L888 22 L900 30 L1040 30" />
        </g>
      </svg>
    </div>
      <nav class="top-nav">
        <a href="index.html" class="nav-link active">Abrir Chamado</a>
        <a href="acompanhamento.html" class="nav-link">Acompanhar Chamado</a>
      </nav>
    </div>
  </header>

  <main class="main-container">
    <section class="hero-section">
      <div class="hero-text">
        
        <p>. Atendimento de 09h as 18h<br>. Em caso de problema nos chamados de remoção, na descrição do problema coloque: <br>   - Número do IRIS ex:(2450) 
          <br>   - Número do Dedalus ex:(111120).</p>
      </div>
    </section>

    <section class="card form-card">
      <h2 class="card-title">Formulário de Chamado</h2>

      <!-- Formulário de criação do chamado -->
      <form id="chamadoForm" class="form-grid">
        <div class="form-field">
          <label for="nome">Nome do solicitante</label>
          <input type="text" id="nome" name="nome" required />
        </div>

        <!-- NOVO: Categoria -->
        <div class="form-field">
          <label for="categoria">Categoria</label>
          <select id="categoria" name="categoria" required>
            <option value="">Selecione</option>
            <option value="Melhoria Dedalus">Melhoria Dedalus</option>
            <option value="Melhoria IRIS">Melhoria IRIS</option>
            <option value="Melhoria Genesys">Melhoria Genesys</option>
            <option value="Erro de Integração">Erro de Integração</option>
            <option value="Erro de App Token">Erro de App Token</option>
            <option value="Erro no Fechamento">Erro no Fechamento</option>
            <option value="Cadastro Estabelecimento">Cadastro Estabelecimento</option>
            <option value="Treinamento Fornecedor">Treinamento Fornecedor</option>
            <option value="Treinamento Solicitante">Treinamento Solicitante</option>
            <option value="Fornecedor com dificuldade">Fornecedor com dificuldade</option>
            <option value="Agendamento">Agendamento</option>
            <option value="Dúvidas">Dúvidas</option>
          </select>
        </div>

        <div class="form-field">
          <label for="assunto">Assunto do chamado</label>
          <input type="text" id="assunto" name="assunto" required />
        </div>

        <!-- NOVO: Urgência -->
        <div class="form-field">
          <label for="urgencia">Urgência</label>
          <select id="urgencia" name="urgencia" required>
            <option value="">Selecione...</option>
            <option value="Vermelho - MUITO GRAVE">Vermelho - MUITO GRAVE</option>
            <option value="Laranja - Resolução para hoje Entre 09h as 17h">Laranja - Resolução para hoje Entre 09h as 17h</option>
            <option value="Amarelo - Até 2 dias">Amarelo - Até 2 dias</option>
            <option value="Verde - Até 10 dias">Verde - Até 10 dias</option>
            <option value="Azul - Demanda Agendada">Azul - Demanda Agendada</option>
          </select>
        </div>
        <div class="form-field full-width">
          <label for="descricao">Descrição do problema</label>
          <textarea id="descricao" name="descricao" rows="4" required></textarea>
        </div>

        <!-- Estrategia de anexo:
             - Convertemos o arquivo em base64 e salvamos no Firestore.
             - Isso continua gratuito dentro das cotas padrão do plano free do Firebase.
             - Para evitar uso exagerado, limitamos o tamanho do arquivo a ~700KB (checado no JS). -->
        <div class="form-field full-width">
          <label for="anexo">Anexo (imagem ou PDF - máx. ~700KB)</label>
          <div class="file-input-wrapper">
            <input type="file" id="anexo" accept="image/*,.pdf" />
            <span class="file-label">Selecionar arquivo</span>
            <span id="anexoNome" class="file-name">Nenhum arquivo selecionado</span>
          </div>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn btn-primary">
            Enviar Chamado
          </button>
        </div>

        <p class="small muted">
          Ao enviar você concorda com o tratamento dos dados para fins de atendimento.
        </p>
      </form>
    </section>
  </main>

  <!-- Modal de feedback (sucesso/erro) -->
  <div id="feedbackModal" class="modal-overlay hidden">
    <div class="modal">
      <div class="modal-icon" id="feedbackIcon">✔️</div>
      <h3 id="feedbackTitle">Chamado enviado com sucesso!</h3>
      <p id="feedbackMessage">
        Seu protocolo é <strong id="feedbackProtocolo"></strong>.
        Guarde este número para acompanhar o chamado.
      </p>
      <button id="feedbackCloseBtn" class="btn btn-primary">OK</button>
    </div>
  </div>

  <!-- Modal genérico para mostrar erros de validação / limite de arquivo -->
  <div id="simpleAlertModal" class="modal-overlay hidden">
    <div class="modal">
      <div class="modal-icon">⚠️</div>
      <h3 id="simpleAlertTitle">Atenção</h3>
      <p id="simpleAlertMessage"></p>
      <button id="simpleAlertCloseBtn" class="btn btn-secondary">Fechar</button>
    </div>
  </div>

  <!-- LOADING GLOBAL -->
  <div id="globalLoading" class="loading-overlay hidden">
    <div class="loading-backdrop"></div>
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <p class="loading-text">Processando seu chamado, por favor aguarde...</p>
    </div>
  </div>

  <!-- Firebase + lógica -->
  <script type="module" src="js/index.js"></script>
</body>
</html>
