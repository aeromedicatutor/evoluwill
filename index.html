<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>EVOLUWILL</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="css/style.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=BBH+Bartle&display=swap" rel="stylesheet"> <!-- Certifique-se de que o link está correto -->
   <link rel="icon" href="img/Ellipse 1.png" type="img/icon">
</head>

<body class="page-light">
  <!-- Cabeçalho global -->
  <header class="app-header">
    <div class="app-header-inner">
      <div class="logo-nome-index">EVOLUWILL</div>
      <nav class="top-nav">
        <a href="index.html" class="nav-link active">Abrir Chamado</a>
        <a href="acompanhamento.html" class="nav-link">Acompanhar Chamado</a>
      </nav>
    </div>
  </header>

  <main class="main-container">
    <section class="hero-section">
      <div class="hero-text">
        
        <p>. Atendimento de 09h as 18h<br>. Em caso de problema nos chamados de remoção, na descrição do problema coloque: <br>   - Número do IRIS ex:(2450) 
          <br>   - Número do Dedalus ex:(111120).</p>
      </div>
    </section>

    <section class="card form-card">
      <h2 class="card-title">Formulário de Chamado</h2>

      <!-- Formulário de criação do chamado -->
      <form id="chamadoForm" class="form-grid">
        <div class="form-field">
          <label for="nome">Nome do solicitante</label>
          <input type="text" id="nome" name="nome" required />
        </div>

        <!-- NOVO: Categoria -->
        <div class="form-field">
          <label for="categoria">Categoria</label>
          <select id="categoria" name="categoria" required>
            <option value="">Selecione...</option>
            <option value="Melhoria Dedalus">Melhoria Dedalus</option>
            <option value="Melhoria IRIS">Melhoria IRIS</option>
            <option value="Melhoria Genesys">Melhoria Genesys</option>
            <option value="Erro de Integração">Erro de Integração</option>
            <option value="Erro no Fechamento">Erro no Fechamento</option>
            <option value="Cadastro Estabelecimento">Cadastro Estabelecimento</option>
            <option value="Treinamento Fornecedor">Treinamento Fornecedor</option>
            <option value="Treinamento Solicitante">Treinamento Solicitante</option>
          </select>
        </div>

        <div class="form-field">
          <label for="assunto">Assunto do chamado</label>
          <input type="text" id="assunto" name="assunto" required />
        </div>

        <!-- NOVO: Urgência -->
        <div class="form-field">
          <label for="urgencia">Urgência</label>
          <select id="urgencia" name="urgencia" required>
            <option value="">Selecione...</option>
            <option value="Vermelho - MUITO GRAVE">Vermelho - MUITO GRAVE</option>
            <option value="Laranja - Resolução para hoje Entre 09h as 17h">
              Laranja - Resolução para hoje Entre 09h as 17h
            </option>
            <option value="Amarelo - Até 3 dias">Amarelo - Até 3 dias</option>
            <option value="Verde - Até 10 dias">Verde - Até 10 dias</option>
            <option value="Azul - Demanda Agendada">Azul - Demanda Agendada</option>
          </select>
        </div>

        <div class="form-field full-width">
          <label for="descricao">Descrição do problema</label>
          <textarea id="descricao" name="descricao" rows="4" required></textarea>
        </div>

        <!-- Estrategia de anexo:
             - Convertemos o arquivo em base64 e salvamos no Firestore.
             - Isso continua gratuito dentro das cotas padrão do plano free do Firebase.
             - Para evitar uso exagerado, limitamos o tamanho do arquivo a ~700KB (checado no JS). -->
        <div class="form-field full-width">
          <label for="anexo">Anexo (imagem ou PDF - máx. ~700KB)</label>
          <div class="file-input-wrapper">
            <input type="file" id="anexo" accept="image/*,.pdf" />
            <span class="file-label">Selecionar arquivo</span>
            <span id="anexoNome" class="file-name">Nenhum arquivo selecionado</span>
          </div>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn btn-primary">
            Enviar Chamado
          </button>
        </div>

        <p class="small muted">
          Ao enviar você concorda com o tratamento dos dados para fins de atendimento.
        </p>
      </form>
    </section>
  </main>

  <!-- Modal de feedback (sucesso/erro) -->
  <div id="feedbackModal" class="modal-overlay hidden">
    <div class="modal">
      <div class="modal-icon" id="feedbackIcon">✔️</div>
      <h3 id="feedbackTitle">Chamado enviado com sucesso!</h3>
      <p id="feedbackMessage">
        Seu protocolo é <strong id="feedbackProtocolo"></strong>.
        Guarde este número para acompanhar o chamado.
      </p>
      <button id="feedbackCloseBtn" class="btn btn-primary">OK</button>
    </div>
  </div>

  <!-- Modal genérico para mostrar erros de validação / limite de arquivo -->
  <div id="simpleAlertModal" class="modal-overlay hidden">
    <div class="modal">
      <div class="modal-icon">⚠️</div>
      <h3 id="simpleAlertTitle">Atenção</h3>
      <p id="simpleAlertMessage"></p>
      <button id="simpleAlertCloseBtn" class="btn btn-secondary">Fechar</button>
    </div>
  </div>

  <!-- LOADING GLOBAL -->
  <div id="globalLoading" class="loading-overlay hidden">
    <div class="loading-backdrop"></div>
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <p class="loading-text">Processando seu chamado, por favor aguarde...</p>
    </div>
  </div>

  <!-- Firebase + lógica -->
  <script type="module" src="js/index.js"></script>
</body>
</html>
