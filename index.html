<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Central de Chamados - Abrir Chamado</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="css/style.css" />
</head>
<body class="page-light">
  <!-- Cabeçalho global -->
  <header class="app-header">
    <div class="app-header-inner">
      <div class="logo">Evoluwill</div>
      <nav class="top-nav">
        <a href="index.html" class="nav-link active">Abrir Chamado</a>
        <a href="acompanhamento.html" class="nav-link">Acompanhar Chamado</a>
      </nav>
    </div>
  </header>

  <main class="main-container">
    <section class="hero-section">
      <div class="hero-text">
        <h1>Abra um novo chamado</h1>
        <p>Descreva o problema e nossa equipe entrará em contato o mais rápido possível.</p>
      </div>
    </section>

    <section class="card form-card">
      <h2 class="card-title">Formulário de Chamado</h2>

      <!-- Formulário de criação do chamado -->
      <form id="chamadoForm" class="form-grid">
        <div class="form-field">
          <label for="nome">Nome do solicitante</label>
          <input type="text" id="nome" name="nome" required />
        </div>

        <div class="form-field">
          <label for="telefone">Telefone do solicitante</label>
          <input type="tel" id="telefone" name="telefone" placeholder="(00) 00000-0000" required />
        </div>

        <div class="form-field">
          <label for="assunto">Assunto do chamado</label>
          <input type="text" id="assunto" name="assunto" required />
        </div>

        <div class="form-field full-width">
          <label for="descricao">Descrição do problema</label>
          <textarea id="descricao" name="descricao" rows="4" required></textarea>
        </div>

        <!-- Estrategia de anexo:
             - Convertemos o arquivo em base64 e salvamos no Firestore.
             - Isso continua gratuito dentro das cotas padrão do plano free do Firebase.
             - Para evitar uso exagerado, limitamos o tamanho do arquivo a ~700KB (checado no JS). -->
        <div class="form-field full-width">
          <label for="anexo">Anexo (imagem ou PDF - máx. ~700KB)</label>
          <div class="file-input-wrapper">
            <input type="file" id="anexo" accept="image/*,.pdf" />
            <span class="file-label">Selecionar arquivo</span>
            <span id="anexoNome" class="file-name">Nenhum arquivo selecionado</span>
          </div>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn btn-primary">
            Enviar Chamado
          </button>
        </div>

        <p class="small muted">
          Ao enviar você concorda com o tratamento dos dados para fins de atendimento.
        </p>
      </form>
    </section>
  </main>

  <!-- Modal de feedback (sucesso/erro) -->
  <div id="feedbackModal" class="modal-overlay hidden">
    <div class="modal">
      <div class="modal-icon" id="feedbackIcon">✔️</div>
      <h3 id="feedbackTitle">Chamado enviado com sucesso!</h3>
      <p id="feedbackMessage">
        Seu protocolo é <strong id="feedbackProtocolo"></strong>.
        Guarde este número para acompanhar o chamado.
      </p>
      <button id="feedbackCloseBtn" class="btn btn-primary">OK</button>
    </div>
  </div>

  <!-- Modal genérico para mostrar erros de validação / limite de arquivo -->
  <div id="simpleAlertModal" class="modal-overlay hidden">
    <div class="modal">
      <div class="modal-icon">⚠️</div>
      <h3 id="simpleAlertTitle">Atenção</h3>
      <p id="simpleAlertMessage"></p>
      <button id="simpleAlertCloseBtn" class="btn btn-secondary">Fechar</button>
    </div>
  </div>

  <!-- Firebase + lógica -->
  <script type="module" src="js/index.js"></script>
</body>
</html>
