<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Acompanhar Evoluwill</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="css/style.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=BBH+Bartle&display=swap" rel="stylesheet"> <!-- Certifique-se de que o link está correto -->
  <link rel="icon" href="img/Ellipse 1.png" type="img/icon">
</head>

<body class="page-light">
<header class="app-header">
  <div class="app-header-inner">
    <div class="logo-nome">Evoluwill</div>
      <!-- ECG decorativo (batimentos) -->
    <div class="header-ecg" aria-hidden="true">
      <svg viewBox="0 0 520 60" role="presentation" focusable="false">
        <path class="ecg-path ecg-track" d="M0 30 L60 30 L80 30 L95 30 L110 30 L125 30 L140 30 L160 30 L180 30 L200 30 L220 30 L240 30 L260 30 L280 30 L300 30 L320 30 L340 30 L360 30 L380 30 L400 30 L420 30 L440 30 L460 30 L520 30" />
        <g class="ecg-move">
          <path class="ecg-path" d="M0 30 L55 30 L70 30 L82 10 L94 50 L108 22 L120 30 L160 30 L175 30 L187 18 L198 42 L212 30 L260 30 L315 30 L330 30 L342 10 L354 50 L368 22 L380 30 L520 30" />
          <path class="ecg-path" d="M520 30 L575 30 L590 30 L602 10 L614 50 L628 22 L640 30 L680 30 L695 30 L707 18 L718 42 L732 30 L780 30 L835 30 L850 30 L862 10 L874 50 L888 22 L900 30 L1040 30" />
        </g>
      </svg>
    </div>
    <nav class="top-nav">
      <a href="index.html" class="nav-link">Abrir Chamado</a>
      <a href="acompanhamento.html" class="nav-link active">Acompanhar Chamado</a>
    </nav>
  </div>
</header>

<main class="main-container">
  <section class="hero-section">
    <div class="hero-text">
      <h1>Acompanhe seu chamado</h1>
      <p>Digite o número do protocolo ou seu nome para ver o status.</p>
    </div>
  </section>

  <section class="card">
    <div class="search-row">
      <div class="acomp-search-card">
        <div class="acomp-search-grid">
          <div class="acomp-field">
            <label for="protocoloInput">Protocolo:</label>
            <input type="text" id="protocoloInput" class="input-pill" placeholder="Protocolo (ex: CH-2025-0001)" />
          </div>
      <div class="acomp-field">
            <label for="nomeInput">Nome:</label>
            <input type="text" id="nomeInput" class="input-pill" placeholder="Ou digite o nome do solicitante" />
          </div>
      <button id="buscarChamadoBtn" class="btn btn-primary btn-medium">Buscar</button>
    </div>
  
    <div id="acompanhamentoResultado" class="cards-grid">
      <!-- Cards dos chamados encontrados serão inseridos aqui -->
    </div>
  </section>
</main>

<!-- Modal de detalhes de acompanhamento (somente leitura) -->
<div id="acompanharModal" class="modal-overlay hidden">
  <div class="modal modal-large">
    <header class="modal-header">
      <span class="pill pill-primary" id="acompModalProtocolo">CH-0000</span>
      <button class="modal-close-btn" id="acompanharFecharBtn">×</button>
    </header>

    <div class="modal-body">
      <div class="modal-grid">
        <div>
          <div class="field-row">
            <span class="field-label">Data de abertura</span>
            <span class="field-value" id="acompanharDataAbertura"></span>
          </div>
          <div class="field-row">
            <span class="field-label">Tempo de abertura</span>
            <span class="field-value" id="acompanharTempoAbertura"></span>
          </div>
        </div>

        <div>
          <div class="field-row">
            <span class="field-label">Status</span>
            <span class="field-value">
              <span id="acompanharStatus" class="status-pill">Em Espera</span>
            </span>
          </div>
          <div class="field-row">
            <span class="field-label">Urgência</span>
            <span class="field-value">
              <span id="acompanharUrgencia" class="urgency-pill">-</span>
            </span>
          </div>
        </div>
      </div>

      <div class="modal-grid">
        <div>
          <div class="field-row">
            <span class="field-label">Nome do solicitante</span>
            <span class="field-value" id="acompanharNome"></span>
          </div>
        </div>
        <div>
          <div class="field-row">
            <span class="field-label">Categoria</span>
            <span class="field-value" id="acompanharCategoria"></span>
          </div>
        </div>
      </div>

      <div class="field-row">
        <span class="field-label">Assunto</span>
        <span class="field-value" id="acompanharAssunto"></span>
      </div>

      <div class="field-row">
        <span class="field-label">Descrição</span>
        <div class="field-value multiline" id="acompanharDescricao"></div>
      </div>

      <div class="field-row">
        <span class="field-label">Anexo</span>
        <div id="acompanharAnexoContainer" class="attachment-box"></div>
      </div>

      <!-- CHAT / COMENTÁRIOS (USUÁRIO / ADM) -->
      <div class="comments-section">
        <div class="comments-header">
          <h3 class="comments-title">Mensagens com o atendimento</h3>
        </div>
        <div id="userCommentsList" class="comments-list">
          <!-- Comentários serão carregados via JS -->
        </div>
        <div class="comments-input-row">
          <textarea
            id="userNewComment"
            placeholder="Escreva uma mensagem para o atendimento."
          ></textarea>
          <button id="userSendCommentBtn" class="btn btn-primary btn-small">
            Enviar
          </button>
        </div>
      </div>
    </div>

    <footer class="modal-footer">
      <!-- Usuário apenas cancela o chamado -->
      <button id="cancelarChamadoBtn" class="btn btn-danger">Cancelar chamado</button>
    </footer>
  </div>
</div>

<!-- Modal simples para mensagens -->
<div id="acompAlertModal" class="modal-overlay hidden">
  <div class="modal">
    <div class="modal-icon">ℹ️</div>
    <h3 id="acompAlertTitle">Mensagem</h3>
    <p id="acompAlertMessage"></p>
    <button id="acompAlertCloseBtn" class="btn btn-secondary">Fechar</button>
  </div>
</div>

<!-- LOADING GLOBAL -->
<div id="globalLoading" class="loading-overlay hidden">
  <div class="loading-backdrop"></div>
  <div class="loading-content">
    <div class="loading-spinner"></div>
    <p class="loading-text">Carregando informações do chamado...</p>
  </div>
</div>

<script type="module" src="js/acompanhamento.js"></script>
</body>
</html>
